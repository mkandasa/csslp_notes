<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSLP Domain 2: Integrated Risk & Compliance</title>
    <style>
        :root {
            --bg: #0f172a;
            --panel: #1e293b;
            --text: #e2e8f0;
            --accent: #f59e0b; /* Amber */
            --iso: #8b5cf6;    /* Violet */
            --pci: #f43f5e;    /* Rose */
            --nist: #3b82f6;   /* Blue */
            --owasp: #10b981;  /* Green */
            --border: #334155;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-bottom: 20px; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .tab-btn {
            background: var(--panel); color: #9ca3af;
            border: 1px solid var(--border); padding: 10px 20px;
            cursor: pointer; border-radius: 6px;
            font-weight: bold; transition: all 0.2s;
        }
        .tab-btn:hover { background: #374151; }
        .tab-btn.active { background: var(--accent); color: #000; border-color: var(--accent); }
        
        .tab-content { display: none; width: 100%; max-width: 1000px; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--panel); padding: 25px; border-radius: 12px;
            border: 1px solid var(--border); height: fit-content; margin-bottom: 20px;
        }
        .card h3 { margin-top: 0; color: var(--accent); border-bottom: 1px solid var(--border); padding-bottom: 10px; }

        /* --- Framework Matcher --- */
        .scenario-box {
            background: #111; padding: 15px; border-radius: 6px; margin-bottom: 15px; border-left: 4px solid #777;
        }
        .scenario-box.correct { border-left-color: var(--owasp); }
        .scenario-box.wrong { border-left-color: var(--pci); }

        .option-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px; }
        .fw-btn {
            padding: 10px; border: 1px solid #555; background: #222; color: #ccc; cursor: pointer; border-radius: 4px;
        }
        .fw-btn:hover { background: #333; }

        /* --- ISO 27034 Visualizer --- */
        .iso-container { display: flex; flex-direction: column; align-items: center; gap: 20px; }
        .onf-box {
            width: 300px; padding: 20px; background: #312e81; border: 2px solid var(--iso);
            border-radius: 8px; text-align: center; position: relative;
        }
        .anf-container { display: flex; gap: 20px; }
        .anf-box {
            width: 150px; padding: 15px; background: #4338ca; border: 2px dashed #818cf8;
            border-radius: 8px; text-align: center; font-size: 0.9rem;
        }
        .arrow-down { font-size: 2rem; color: #666; }

        /* --- SAMM Assessor --- */
        .samm-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .samm-col { background: #111; padding: 10px; border-radius: 6px; text-align: center; border: 1px solid #333; }
        .samm-col h4 { margin: 0 0 10px 0; font-size: 0.9rem; color: var(--owasp); }
        select { width: 100%; background: #222; color: white; border: 1px solid #444; padding: 5px; }
        
        .score-bar { height: 10px; background: #333; margin-top: 5px; border-radius: 5px; overflow: hidden; }
        .score-fill { height: 100%; width: 0%; background: var(--owasp); transition: width 0.5s; }

        /* --- Log --- */
        .log-terminal {
            grid-column: span 2; background: #000; height: 120px; 
            padding: 10px; overflow-y: auto; font-family: monospace; 
            border: 1px solid var(--border); color: #a6e3a1; font-size: 0.9rem; margin-top: 20px;
        }
        .log-err { color: var(--pci); }
        .log-ok { color: var(--owasp); }

    </style>
</head>
<body>

    <h1>CSSLP: Regulations, Standards & Guidelines</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('matcher')">1. Framework Matcher</button>
        <button class="tab-btn" onclick="switchTab('iso')">2. ISO 27034 (ONF/ANF)</button>
        <button class="tab-btn" onclick="switchTab('samm')">3. OWASP SAMM</button>
    </div>

    <!-- TAB 1: MATCHER -->
    <div id="matcher" class="tab-content active">
        <div class="card">
            <h3>Scenario Matcher</h3>
            <p>Read the scenario and select the governing standard.</p>
            
            <div id="scenarioContainer">
                <div class="scenario-box" id="scen1">
                    <strong>Scenario 1:</strong> You are building an e-commerce site that accepts Visa and Mastercard.
                    <div class="option-grid">
                        <button class="fw-btn" onclick="checkMatch(1, 'iso')">ISO 27001</button>
                        <button class="fw-btn" onclick="checkMatch(1, 'pci')">PCI-DSS</button>
                        <button class="fw-btn" onclick="checkMatch(1, 'hipaa')">HIPAA</button>
                        <button class="fw-btn" onclick="checkMatch(1, 'nist')">NIST 800-53</button>
                    </div>
                </div>

                <div class="scenario-box" id="scen2" style="display:none">
                    <strong>Scenario 2:</strong> You are selling software to the US Federal Government.
                    <div class="option-grid">
                        <button class="fw-btn" onclick="checkMatch(2, 'owasp')">OWASP Top 10</button>
                        <button class="fw-btn" onclick="checkMatch(2, 'nist')">NIST 800-53 / RMF</button>
                        <button class="fw-btn" onclick="checkMatch(2, 'pci')">PCI-DSS</button>
                        <button class="fw-btn" onclick="checkMatch(2, 'iso')">ISO 9001</button>
                    </div>
                </div>

                <div class="scenario-box" id="scen3" style="display:none">
                    <strong>Scenario 3:</strong> You want a list of the most critical web vulnerabilities to train developers.
                    <div class="option-grid">
                        <button class="fw-btn" onclick="checkMatch(3, 'safecode')">SAFECode</button>
                        <button class="fw-btn" onclick="checkMatch(3, 'bsimm')">BSIMM</button>
                        <button class="fw-btn" onclick="checkMatch(3, 'owasp')">OWASP Top 10</button>
                        <button class="fw-btn" onclick="checkMatch(3, 'iso')">ISO 27034</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 2: ISO 27034 -->
    <div id="iso" class="tab-content">
        <div class="card">
            <h3>ISO/IEC 27034: Application Security</h3>
            <p><strong>The Concept:</strong> Define controls ONCE in the Organization Normative Framework (ONF), then apply subsets to each app in the Application Normative Framework (ANF).</p>

            <div class="iso-container">
                <div class="onf-box">
                    <strong>ONF (Organization Level)</strong><br>
                    <small>Library of ALL Controls</small><br>
                    <span style="font-size:0.8rem; color:#aaa">[AuthZ Policy] [Crypto Standard] [Audit Rules] [Input Validation]</span>
                </div>
                
                <div class="arrow-down">⬇ Select & Apply ⬇</div>

                <div class="anf-container">
                    <div class="anf-box">
                        <strong>ANF (App A)</strong><br>
                        <small>Public Website</small><br>
                        <hr style="border:0; border-top:1px dashed #aaa; margin:5px 0">
                        <ul style="text-align:left; padding-left:15px; margin:0">
                            <li>Input Validation</li>
                            <li>TLS Config</li>
                        </ul>
                    </div>
                    <div class="anf-box">
                        <strong>ANF (App B)</strong><br>
                        <small>Internal HR DB</small><br>
                        <hr style="border:0; border-top:1px dashed #aaa; margin:5px 0">
                        <ul style="text-align:left; padding-left:15px; margin:0">
                            <li>AuthZ Policy</li>
                            <li>Audit Rules</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div style="margin-top:20px; text-align:center">
                <button onclick="log('ISO 27034: Using ONF ensures consistency across all apps.', 'ok')" style="background:var(--iso); color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer">Validate Framework</button>
            </div>
        </div>
    </div>

    <!-- TAB 3: SAMM -->
    <div id="samm" class="tab-content">
        <div class="card">
            <h3>OWASP SAMM Assessment</h3>
            <p>Rate your organization's maturity (Level 0-3).</p>
            
            <div class="samm-grid">
                <div class="samm-col">
                    <h4>Governance</h4>
                    <select onchange="updateSamm()" id="s1"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
                    <div class="score-bar"><div class="score-fill" id="b1"></div></div>
                </div>
                <div class="samm-col">
                    <h4>Design</h4>
                    <select onchange="updateSamm()" id="s2"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
                    <div class="score-bar"><div class="score-fill" id="b2"></div></div>
                </div>
                <div class="samm-col">
                    <h4>Implement</h4>
                    <select onchange="updateSamm()" id="s3"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
                    <div class="score-bar"><div class="score-fill" id="b3"></div></div>
                </div>
                <div class="samm-col">
                    <h4>Verify</h4>
                    <select onchange="updateSamm()" id="s4"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
                    <div class="score-bar"><div class="score-fill" id="b4"></div></div>
                </div>
            </div>

            <div id="sammScore" style="text-align:center; margin-top:20px; font-weight:bold; font-size:1.2rem; color:var(--owasp)">
                Overall Maturity: 0.0
            </div>
        </div>
    </div>

    <!-- LOGS -->
    <div class="log-terminal" id="logs">
        <div>> Compliance Engine Ready.</div>
    </div>

    <script>
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const map = {'matcher':0, 'iso':1, 'samm':2};
            document.querySelectorAll('.tab-btn')[map[id]].classList.add('active');
        }

        function log(msg, type='info') {
            const term = document.getElementById('logs');
            const cls = type === 'err' ? 'log-err' : (type === 'ok' ? 'log-ok' : '');
            term.innerHTML += `<div class="${cls}">> ${msg}</div>`;
            term.scrollTop = term.scrollHeight;
        }

        /* --- MATCHER LOGIC --- */
        function checkMatch(scenId, answer) {
            const el = document.getElementById(`scen${scenId}`);
            let correct = false;
            let msg = "";

            if (scenId === 1 && answer === 'pci') { correct = true; msg = "Correct! Credit Cards = PCI-DSS."; }
            else if (scenId === 2 && answer === 'nist') { correct = true; msg = "Correct! US Gov = NIST 800-53."; }
            else if (scenId === 3 && answer === 'owasp') { correct = true; msg = "Correct! Web Vulns = OWASP Top 10."; }
            else { msg = "Incorrect. Try again."; }

            if (correct) {
                log(msg, 'ok');
                el.classList.add('correct');
                // Next
                setTimeout(() => {
                    if (scenId < 3) {
                        el.style.display = 'none';
                        document.getElementById(`scen${scenId+1}`).style.display = 'block';
                    } else {
                        log("All Scenarios Completed!", 'ok');
                    }
                }, 1000);
            } else {
                log(msg, 'err');
                el.classList.add('wrong');
                setTimeout(() => el.classList.remove('wrong'), 500);
            }
        }

        /* --- SAMM LOGIC --- */
        function updateSamm() {
            let total = 0;
            for(let i=1; i<=4; i++) {
                const val = parseInt(document.getElementById(`s${i}`).value);
                document.getElementById(`b${i}`).style.width = (val * 33) + "%";
                total += val;
            }
            const avg = (total / 4).toFixed(1);
            document.getElementById('sammScore').innerText = `Overall Maturity: ${avg}`;
            
            if(avg > 2) log("High Maturity achieved. You are proactive.", 'ok');
            else if(avg > 1) log("Medium Maturity. Standardized but not optimized.");
            else log("Low Maturity. Processes are ad-hoc.", 'err');
        }

    </script>
</body>
</html>