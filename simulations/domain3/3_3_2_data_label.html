<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSLP Domain 3: Data Labeling & Impact</title>
    <style>
        :root {
            --bg: #0f172a;
            --panel: #1e293b;
            --text: #f8fafc;
            --accent: #38bdf8; /* Light Blue */
            --pii: #f43f5e;    /* Rose (Restricted) */
            --conf: #f59e0b;   /* Amber (Confidential) */
            --pub: #10b981;    /* Green (Public) */
            --border: #334155;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-bottom: 20px; text-align: center; }

        .container {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
            width: 100%; max-width: 1000px;
        }

        .card {
            background: var(--panel); padding: 25px; border-radius: 12px;
            border: 1px solid var(--border); height: fit-content; margin-bottom: 20px;
        }
        .card h3 { margin-top: 0; color: var(--accent); border-bottom: 1px solid var(--border); padding-bottom: 10px; }

        /* --- File Cards --- */
        .file-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .file-card {
            background: #111; padding: 15px; border-radius: 8px; border: 1px solid #444;
            text-align: center; position: relative; cursor: pointer; transition: all 0.2s;
        }
        .file-card:hover { border-color: var(--accent); transform: translateY(-2px); }
        .file-card.selected { border-color: var(--accent); background: #1e293b; box-shadow: 0 0 10px rgba(56, 189, 248, 0.2); }
        .file-icon { font-size: 2.5rem; display: block; margin-bottom: 10px; }
        
        .label-badge {
            position: absolute; top: -10px; right: -5px; padding: 2px 8px; border-radius: 10px;
            font-size: 0.7rem; font-weight: bold; display: none; background: #000; border: 1px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* --- Buttons --- */
        button {
            padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer;
            font-weight: bold; transition: opacity 0.2s; width: 100%; margin-top: 10px;
        }
        button:hover { opacity: 0.9; }
        .btn-label { width: auto; margin: 5px; background: transparent; border: 2px solid #555; color: #fff; }
        .btn-action { background: var(--accent); color: #000; font-size: 1rem; padding: 12px; }

        /* --- Impact Meter --- */
        .impact-container { margin-top: 20px; padding: 15px; background: #111; border-radius: 8px; border: 1px dashed #444; }
        .impact-meter { height: 12px; background: #333; border-radius: 6px; margin-top: 10px; overflow: hidden; }
        .impact-fill { height: 100%; width: 0%; background: #555; transition: width 0.5s, background 0.5s; }
        .impact-val { text-align: right; font-size: 0.8rem; margin-top: 5px; font-weight: bold; min-height: 1.2em; }

        /* --- DLP Scanner --- */
        .dlp-scanner {
            border: 2px dashed #555; padding: 20px; border-radius: 8px; text-align: center;
            margin-top: 20px; background: #0f172a; position: relative; overflow: hidden; height: 100px;
            display: flex; align-items: center; justify-content: center;
        }
        .dlp-packet {
            width: 50px; height: 60px; background: #222; border: 2px solid #fff;
            position: absolute; top: 20px; left: -60px; display: flex; align-items: center; justify-content: center;
            border-radius: 4px; font-size: 1.5rem; z-index: 10;
        }
        .gate-line {
            position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: #444;
            z-index: 5;
        }
        .gate-label {
            position: absolute; left: 50%; top: 5px; transform: translateX(-50%); 
            background: #0f172a; padding: 0 5px; font-size: 0.7rem; color: #aaa; z-index: 6;
        }

        /* --- Logs --- */
        .log-terminal {
            grid-column: span 2; background: #000; height: 150px; 
            padding: 10px; overflow-y: auto; font-family: monospace; 
            border: 1px solid var(--border); color: var(--accent); font-size: 0.9rem;
        }
        .log-err { color: var(--pii); }
        .log-ok { color: var(--pub); }
        .log-warn { color: var(--conf); }

    </style>
</head>
<body>

    <h1>CSSLP: Data Labeling & Impact Console</h1>

    <div class="container">
        
        <!-- Left Column: Labeling -->
        <div class="card">
            <h3>1. Apply Labels</h3>
            <p>Select a data asset to classify.</p>
            
            <div class="file-grid">
                <div class="file-card" onclick="selectFile(this, 'marketing')">
                    <span class="file-icon">üìÑ</span>
                    Marketing.pdf
                    <span class="label-badge" id="badge-marketing"></span>
                </div>
                <div class="file-card" onclick="selectFile(this, 'payroll')">
                    <span class="file-icon">üìä</span>
                    Payroll.xlsx
                    <span class="label-badge" id="badge-payroll"></span>
                </div>
                <div class="file-card" onclick="selectFile(this, 'source')">
                    <span class="file-icon">üíª</span>
                    Source.zip
                    <span class="label-badge" id="badge-source"></span>
                </div>
            </div>

            <div style="margin-top:20px; text-align:center; display:none; border-top:1px solid #333; padding-top:15px;" id="labelActions">
                <strong>Select Classification Label:</strong><br>
                <div style="display:flex; justify-content:center; flex-wrap:wrap;">
                    <button class="btn-label" style="border-color:var(--pub); color:var(--pub)" onclick="applyLabel('PUBLIC')">PUBLIC</button>
                    <button class="btn-label" style="border-color:var(--conf); color:var(--conf)" onclick="applyLabel('CONFIDENTIAL')">CONFIDENTIAL</button>
                    <button class="btn-label" style="border-color:var(--pii); color:var(--pii)" onclick="applyLabel('RESTRICTED')">RESTRICTED</button>
                </div>
            </div>
        </div>

        <!-- Right Column: Impact & Enforcement -->
        <div class="card">
            <h3>2. Impact Analysis & DLP</h3>
            <p>Visualize the "Blast Radius" and test network controls.</p>
            
            <div class="impact-container">
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:#aaa; margin-bottom:5px;">
                    <span>Impact Potential</span>
                    <span>(Integrity/Availability/Confidentiality)</span>
                </div>
                <div class="impact-meter"><div class="impact-fill" id="impactBar"></div></div>
                <div class="impact-val" id="impactText">Select a file...</div>
            </div>

            <div class="dlp-scanner">
                <div class="gate-line"></div>
                <div class="gate-label">DLP GATEWAY</div>
                <div id="dlpPacket" class="dlp-packet">üìÑ</div>
            </div>

            <button class="btn-action" onclick="runDLP()">üöÄ Simulate Data Exfiltration</button>
        </div>

        <!-- Logs -->
        <div class="log-terminal" id="logs">
            <div>> System Initialized. Waiting for input...</div>
        </div>

    </div>

    <script>
        let selectedFile = null;
        const fileLabels = {
            'marketing': null,
            'payroll': null,
            'source': null
        };

        const fileIcons = {
            'marketing': 'üìÑ',
            'payroll': 'üìä',
            'source': 'üíª'
        };

        function log(msg, type='info') {
            const term = document.getElementById('logs');
            const cls = type === 'err' ? 'log-err' : (type === 'ok' ? 'log-ok' : (type === 'warn' ? 'log-warn' : ''));
            term.innerHTML += `<div class="${cls}">> ${msg}</div>`;
            term.scrollTop = term.scrollHeight;
        }

        function selectFile(el, id) {
            document.querySelectorAll('.file-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            selectedFile = id;
            document.getElementById('labelActions').style.display = 'block';
            
            // Reset visualizations
            document.getElementById('dlpPacket').style.left = '-60px';
            document.getElementById('dlpPacket').innerHTML = fileIcons[id];
            
            updateImpact(); // Refresh impact view for newly selected file
            log(`Selected asset: ${id.toUpperCase()}`);
        }

        function applyLabel(label) {
            if (!selectedFile) return;
            
            fileLabels[selectedFile] = label;
            const badge = document.getElementById(`badge-${selectedFile}`);
            badge.innerText = label;
            badge.style.display = 'block';
            
            let color = '#fff';
            if (label === 'PUBLIC') color = 'var(--pub)';
            if (label === 'CONFIDENTIAL') color = 'var(--conf)';
            if (label === 'RESTRICTED') color = 'var(--pii)';
            
            badge.style.color = color;
            badge.style.borderColor = color;

            log(`Metadata Update: ${selectedFile} tagged as [${label}].`, 'info');
            updateImpact();
        }

        function updateImpact() {
            const bar = document.getElementById('impactBar');
            const txt = document.getElementById('impactText');

            if (!selectedFile) {
                bar.style.width = "0%";
                txt.innerText = "Select a file...";
                return;
            }

            const label = fileLabels[selectedFile];
            
            if (!label) {
                bar.style.width = "0%";
                bar.style.background = "#333";
                txt.innerText = "Unlabeled (Unknown Impact)";
                return;
            }
            
            if (label === 'PUBLIC') {
                bar.style.width = "15%"; 
                bar.style.background = "var(--pub)";
                txt.innerText = "LOW IMPACT: Public disclosure is acceptable.";
                txt.style.color = "var(--pub)";
            } else if (label === 'CONFIDENTIAL') {
                bar.style.width = "60%"; 
                bar.style.background = "var(--conf)";
                txt.innerText = "MODERATE IMPACT: Internal harm if leaked.";
                txt.style.color = "var(--conf)";
            } else { // RESTRICTED
                bar.style.width = "100%"; 
                bar.style.background = "var(--pii)";
                txt.innerText = "HIGH IMPACT: Critical damage (Fines/Reputation).";
                txt.style.color = "var(--pii)";
            }
        }

        function runDLP() {
            if (!selectedFile) { alert("Select a file first."); return; }
            
            const pkt = document.getElementById('dlpPacket');
            const label = fileLabels[selectedFile];
            
            // Reset Animation
            pkt.style.transition = 'none';
            pkt.style.left = '-60px';
            pkt.style.borderColor = "#fff";
            pkt.style.boxShadow = "none";
            
            log(`DLP Agent: Inspecting network traffic for ${selectedFile}...`);

            // Animate to gate
            setTimeout(() => {
                pkt.style.transition = 'left 1s linear';
                pkt.style.left = '45%'; // Center on gate
                
                setTimeout(() => {
                    // Enforcement Logic
                    if (label === 'RESTRICTED') {
                        log("üõë BLOCK: Restricted data detected crossing boundary!", 'err');
                        pkt.style.borderColor = "var(--pii)";
                        pkt.style.boxShadow = "0 0 15px var(--pii)";
                        // Visual Stop
                    } 
                    else if (label === 'CONFIDENTIAL') {
                        log("‚ö†Ô∏è WARNING: Confidential data export. Logged for audit.", 'warn');
                        pkt.style.borderColor = "var(--conf)";
                        pkt.style.left = '120%'; // Pass through
                    } 
                    else if (label === 'PUBLIC') {
                        log("‚úÖ ALLOW: Public data. No restriction.", 'ok');
                        pkt.style.borderColor = "var(--pub)";
                        pkt.style.left = '120%'; // Pass through
                    } 
                    else {
                        // Unlabeled
                        log("‚ö†Ô∏è ALLOW (DEFAULT): Data has no label. DLP cannot enforce policy. Risk!", 'warn');
                        pkt.style.borderColor = "#777";
                        pkt.style.left = '120%'; // Pass through
                    }
                }, 1000);
            }, 100);
        }

    </script>
</body>
</html>