<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSLP Domain 2: Risk Management Console</title>
    <style>
        :root {
            --bg: #0f172a;
            --panel: #1e293b;
            --text: #f1f5f9;
            --accent: #f43f5e; /* Rose */
            --pass: #10b981;   /* Green */
            --fail: #ef4444;   /* Red */
            --warn: #f59e0b;   /* Amber */
            --info: #3b82f6;   /* Blue */
            --calc: #8b5cf6;   /* Violet */
            --biz: #22d3ee;    /* Cyan for Business */
            --border: #334155;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-bottom: 20px; text-align: center; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .tab-btn {
            background: var(--panel); color: #9ca3af;
            border: 1px solid var(--border); padding: 10px 20px;
            cursor: pointer; border-radius: 6px;
            font-weight: bold; transition: all 0.2s;
        }
        .tab-btn:hover { background: #374151; }
        .tab-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
        
        .tab-content { display: none; width: 100%; max-width: 1000px; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--panel); padding: 25px; border-radius: 12px;
            border: 1px solid var(--border); height: fit-content; margin-bottom: 20px;
        }
        .card h3 { margin-top: 0; color: var(--accent); border-bottom: 1px solid var(--border); padding-bottom: 10px; }

        button {
            padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer;
            font-weight: bold; transition: opacity 0.2s; margin-top: 10px;
        }
        button:hover { opacity: 0.9; }
        .btn-calc { background: var(--calc); color: white; }
        .btn-action { background: var(--info); color: white; }
        .btn-biz { background: var(--biz); color: black; }

        /* --- Quantitative Styles --- */
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; color: #aaa; font-size: 0.9rem; }
        .input-group input { width: 100%; padding: 8px; background: #111; border: 1px solid #555; color: white; border-radius: 4px; box-sizing: border-box; }
        
        .ale-result {
            font-size: 2.5rem; font-weight: bold; color: var(--pass); text-align: center; margin-top: 10px;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
        }
        .roi-box {
            background: #111; padding: 15px; border-radius: 6px; margin-top: 15px; border: 1px dashed #555; font-size: 0.9rem;
        }

        /* --- Qualitative Styles --- */
        .matrix-container {
            display: grid; grid-template-columns: 30px repeat(3, 1fr); gap: 2px;
            width: 350px; margin: 0 auto;
        }
        .matrix-cell {
            height: 70px; border: 1px solid #333; display: flex; align-items: center; justify-content: center;
            font-size: 0.85rem; font-weight: bold; cursor: pointer; transition: all 0.2s; position: relative; color: #000;
        }
        .matrix-cell:hover { opacity: 0.8; transform: scale(1.05); z-index: 2; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
        
        .risk-dot {
            width: 18px; height: 18px; border-radius: 50%; background: #fff; border: 2px solid #000;
            position: absolute; box-shadow: 0 0 5px #000; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- Translation Styles --- */
        .risk-card {
            background: #111; border: 1px solid #444; border-radius: 8px; padding: 15px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .tech-finding { color: var(--warn); font-family: monospace; font-weight: bold; }
        .biz-select { background: #222; color: white; border: 1px solid #555; padding: 5px; border-radius: 4px; margin-left: 10px; width: 200px; }
        
        .pitch-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .cfo-response {
            background: #000; border: 2px solid #555; padding: 20px; border-radius: 8px;
            height: 100px; display: flex; align-items: center; justify-content: center;
            font-style: italic; color: #aaa; text-align: center;
        }

        /* --- Log --- */
        .log-terminal {
            grid-column: span 2; background: #000; height: 150px; 
            padding: 10px; overflow-y: auto; font-family: monospace; 
            border: 1px solid var(--border); color: #a6e3a1; font-size: 0.9rem; margin-top: 20px;
        }
        .log-err { color: var(--fail); }
        .log-warn { color: var(--warn); }
        .log-info { color: var(--info); }

    </style>
</head>
<body>

    <h1>CSSLP: Risk Management Console</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('quant')">1. Quantitative (ALE)</button>
        <button class="tab-btn" onclick="switchTab('qual')">2. Qualitative (Matrix)</button>
        <button class="tab-btn" onclick="switchTab('treat')">3. Risk Treatment</button>
        <button class="tab-btn" onclick="switchTab('trans')">4. Tech vs. Business</button>
    </div>

    <!-- TAB 1: QUANTITATIVE RISK -->
    <div id="quant" class="tab-content active">
        <div class="container" style="display:grid; grid-template-columns:1fr 1fr; gap:20px; width:100%; max-width:900px;">
            <div class="card">
                <h3>ALE Calculator</h3>
                <p><strong>ALE = SLE Ã— ARO</strong><br>(Single Loss Ã— Annual Rate)</p>
                <div class="input-group">
                    <label>Asset Value ($)</label>
                    <input type="number" id="av" value="100000">
                </div>
                <div class="input-group">
                    <label>Exposure Factor (%)</label>
                    <input type="number" id="ef" value="50">
                </div>
                <div class="input-group">
                    <label>Annual Rate (ARO)</label>
                    <input type="number" id="aro" value="0.1" step="0.1" placeholder="0.1 = Once every 10 years">
                </div>
                <button class="btn-calc" onclick="calcRisk()">Calculate Risk ($)</button>
            </div>
            <div class="card">
                <h3>Financial Analysis</h3>
                <div style="text-align:center; padding:20px 0;">
                    <div style="font-size:0.9rem; color:#aaa">Annualized Loss Expectancy (ALE)</div>
                    <div class="ale-result" id="aleDisplay">$0</div>
                </div>
                <div class="roi-box" id="roiBox" style="display:none">
                    <strong>Budget Decision:</strong><br>
                    Proposed Control: <strong>Firewall ($10,000)</strong><br>
                    <div id="roiResult" style="margin-top:10px; font-weight:bold;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 2: QUALITATIVE RISK -->
    <div id="qual" class="tab-content">
        <div class="card" style="max-width:600px; margin:0 auto;">
            <h3>Risk Heatmap</h3>
            <p>Drag the "Current Risk" to classify it.</p>
            <div style="text-align:center; margin-bottom:15px;">
                <span style="background:#333; padding:8px 15px; border-radius:20px; border:1px solid #555;">Current Risk: <strong>Data Center Fire</strong></span>
            </div>
            <div class="matrix-container">
                <div style="writing-mode: vertical-rl; transform: rotate(180deg); text-align:center; font-weight:bold; color:#aaa;">PROBABILITY</div>
                <!-- Matrix Cells -->
                <div class="matrix-cell" style="background:#ffffcc" onclick="placeRisk(this, 'Medium')">High Prob<br>Low Imp</div>
                <div class="matrix-cell" style="background:#ffcc99" onclick="placeRisk(this, 'High')">High Prob<br>Med Imp</div>
                <div class="matrix-cell" style="background:#ff9999" onclick="placeRisk(this, 'Critical')">High Prob<br>High Imp</div>
                
                <div class="matrix-cell" style="background:#ccffcc" onclick="placeRisk(this, 'Low')">Med Prob<br>Low Imp</div>
                <div class="matrix-cell" style="background:#ffffcc" onclick="placeRisk(this, 'Medium')">Med Prob<br>Med Imp</div>
                <div class="matrix-cell" style="background:#ffcc99" onclick="placeRisk(this, 'High')">High Prob<br>Med Imp</div>
                
                <div class="matrix-cell" style="background:#ccffcc" onclick="placeRisk(this, 'Low')">Low Prob<br>Low Imp</div>
                <div class="matrix-cell" style="background:#ccffcc" onclick="placeRisk(this, 'Low')">Low Prob<br>Med Imp</div>
                <div class="matrix-cell" style="background:#ffffcc" onclick="placeRisk(this, 'Medium')">Low Prob<br>High Imp</div>
                
                <div></div>
                <div style="text-align:center; font-size:0.8rem; padding-top:5px; font-weight:bold; color:#aaa;">Low</div>
                <div style="text-align:center; font-size:0.8rem; padding-top:5px; font-weight:bold; color:#aaa;">Medium</div>
                <div style="text-align:center; font-size:0.8rem; padding-top:5px; font-weight:bold; color:#aaa;">High</div>
            </div>
            <div style="text-align:center; margin-top:5px; font-weight:bold; color:#aaa;">IMPACT âžœ</div>
        </div>
    </div>

    <!-- TAB 3: TREATMENT -->
    <div id="treat" class="tab-content">
        <div class="card" style="max-width:800px; margin:0 auto;">
            <h3>Risk Treatment Decisions</h3>
            <p><strong>Scenario:</strong> ALE = $5,000. Mitigation Cost = $50,000.</p>
            <div style="display:grid; grid-template-columns: repeat(2, 1fr); gap:15px; margin-top:20px;">
                <button class="btn-action" style="background:var(--fail)" onclick="treatRisk('avoid')"><strong>AVOID</strong><br><small>Stop activity.</small></button>
                <button class="btn-action" style="background:var(--warn)" onclick="treatRisk('mitigate')"><strong>MITIGATE</strong><br><small>Apply Control.</small></button>
                <button class="btn-action" style="background:var(--info)" onclick="treatRisk('transfer')"><strong>TRANSFER</strong><br><small>Buy Insurance.</small></button>
                <button class="btn-action" style="background:var(--pass)" onclick="treatRisk('accept')"><strong>ACCEPT</strong><br><small>Sign off.</small></button>
            </div>
        </div>
    </div>

    <!-- TAB 4: TRANSLATION (NEW) -->
    <div id="trans" class="tab-content">
        <div class="card" style="max-width:900px; margin:0 auto;">
            <h3>The Translator: Tech -> Business</h3>
            <p>Map the technical finding to the business consequence to unlock the budget.</p>
            
            <div class="pitch-container">
                <div>
                    <div class="risk-card">
                        <div>
                            <div class="tech-finding">1. SQL Injection Vulnerability</div>
                            <small style="color:#aaa">Found in User Login module.</small>
                        </div>
                        <select id="biz1" class="biz-select">
                            <option value="none">-- Select Impact --</option>
                            <option value="perf">Slow Database Performance</option>
                            <option value="fraud">Massive Data Breach / Fines</option>
                        </select>
                    </div>

                    <div class="risk-card">
                        <div>
                            <div class="tech-finding">2. Expired SSL Certificate</div>
                            <small style="color:#aaa">Public facing website.</small>
                        </div>
                        <select id="biz2" class="biz-select">
                            <option value="none">-- Select Impact --</option>
                            <option value="rep">Reputation / Trust Loss</option>
                            <option value="hack">Ransomware Infection</option>
                        </select>
                    </div>

                    <div class="risk-card">
                        <div>
                            <div class="tech-finding">3. Hardcoded AWS Keys</div>
                            <small style="color:#aaa">Found in GitHub repo.</small>
                        </div>
                        <select id="biz3" class="biz-select">
                            <option value="none">-- Select Impact --</option>
                            <option value="fin">Uncontrolled Cloud Costs / Theft</option>
                            <option value="ui">Bad User Experience</option>
                        </select>
                    </div>
                    
                    <button class="btn-biz" onclick="pitchToCFO()">ðŸ’° Pitch to CFO</button>
                </div>

                <div class="cfo-response" id="cfoBox">
                    "I don't understand 'SQL Injection'. Why should I care?"
                </div>
            </div>
        </div>
    </div>

    <!-- LOGS -->
    <div class="log-terminal" id="logs">
        <div>> Risk Management Console Loaded.</div>
    </div>

    <script>
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const map = {'quant':0, 'qual':1, 'treat':2, 'trans':3};
            document.querySelectorAll('.tab-btn')[map[id]].classList.add('active');
        }

        function log(msg, type='info') {
            const term = document.getElementById('logs');
            const cls = type === 'err' ? 'log-err' : (type === 'ok' ? 'log-info' : 'log-warn');
            term.innerHTML += `<div class="${cls}">> ${msg}</div>`;
            term.scrollTop = term.scrollHeight;
        }

        /* --- QUANTITATIVE LOGIC --- */
        function calcRisk() {
            const av = parseFloat(document.getElementById('av').value);
            const ef = parseFloat(document.getElementById('ef').value) / 100;
            const aro = parseFloat(document.getElementById('aro').value);
            const sle = av * ef;
            const ale = sle * aro;

            document.getElementById('aleDisplay').innerText = "$" + ale.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
            
            const controlCost = 10000;
            document.getElementById('roiBox').style.display = 'block';
            const roiRes = document.getElementById('roiResult');

            if (controlCost < ale) {
                roiRes.innerHTML = `<span style="color:var(--pass)">APPROVED.</span> Cost ($10k) < Loss ($${ale.toLocaleString()}).`;
                log("Control Approved. Positive ROI.", 'ok');
            } else {
                roiRes.innerHTML = `<span style="color:var(--fail)">REJECTED.</span> Cost ($10k) > Loss ($${ale.toLocaleString()}).`;
                log("Control Rejected. Negative ROI.", 'err');
            }
        }

        /* --- QUALITATIVE LOGIC --- */
        function placeRisk(cell, level) {
            document.querySelectorAll('.risk-dot').forEach(d => d.remove());
            const dot = document.createElement('div');
            dot.className = 'risk-dot';
            dot.style.top = '25px'; dot.style.left = '40px';
            cell.appendChild(dot);
            log(`Risk Classified as: ${level.toUpperCase()}.`, level === 'Low' ? 'ok' : 'err');
        }

        /* --- TREATMENT LOGIC --- */
        function treatRisk(type) {
            if (type === 'accept') log("DECISION: ACCEPT. Correct! Cost > Loss.", 'ok');
            else if (type === 'mitigate') log("DECISION: MITIGATE. Bad Business. You lost money.", 'err');
            else if (type === 'transfer') log("DECISION: TRANSFER. Maybe, but insurance has deductibles.", 'warn');
            else log("DECISION: AVOID. Too extreme for a $5k risk.", 'warn');
        }

        /* --- TRANSLATION LOGIC (New) --- */
        function pitchToCFO() {
            const b1 = document.getElementById('biz1').value;
            const b2 = document.getElementById('biz2').value;
            const b3 = document.getElementById('biz3').value;
            const cfo = document.getElementById('cfoBox');

            if (b1 === 'fraud' && b2 === 'rep' && b3 === 'fin') {
                cfo.innerHTML = `<span style="color:var(--pass); font-weight:bold;">"APPROVED! You clearly articulated the financial and reputation risks. Budget granted."</span>`;
                cfo.style.borderColor = "var(--pass)";
                log("Pitch Successful: Translated Technical Jargon to Business Value.", 'ok');
            } else {
                cfo.innerHTML = `<span style="color:var(--fail)">"DENIED. I still don't see how 'SSL' affects our bottom line. Come back when you can explain the business impact."</span>`;
                cfo.style.borderColor = "var(--fail)";
                log("Pitch Failed: CFO did not understand the risk.", 'err');
            }
        }

    </script>
</body>
</html>