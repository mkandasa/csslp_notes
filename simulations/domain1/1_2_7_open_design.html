<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSLP Domain 1: Open Design</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --bg: #1e1e2e;
            --panel: #2b2b3d;
            --text: #cdd6f4;
            --accent: #f5c2e7; /* Pink */
            --obscure: #f38ba8; /* Red */
            --open: #a6e3a1;   /* Green */
            --review: #89b4fa; /* Blue */
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-bottom: 20px; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .tab-btn {
            background: var(--panel); color: #94a3b8;
            border: 1px solid #45475a; padding: 10px 20px;
            cursor: pointer; border-radius: 6px;
            font-weight: bold; transition: all 0.2s;
        }
        .tab-btn:hover { background: #45475a; }
        .tab-btn.active { background: var(--accent); color: #1e1e2e; border-color: var(--accent); }
        
        .tab-content { display: none; width: 100%; max-width: 900px; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .card {
            background: var(--panel); padding: 25px; border-radius: 12px;
            border: 1px solid #45475a; margin-bottom: 20px; position: relative;
        }
        .card h3 { margin-top: 0; color: var(--accent); border-bottom: 1px solid #45475a; padding-bottom: 10px; }

        /* General UI */
        button {
            padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer;
            font-weight: bold; transition: opacity 0.2s; margin-top: 10px;
        }
        button:hover { opacity: 0.9; }
        .btn-obscure { background: var(--obscure); color: #1e1e2e; }
        .btn-open { background: var(--open); color: #1e1e2e; }
        .btn-review { background: var(--review); color: #1e1e2e; }
        .btn-tool { background: #585b70; color: white; border: 1px solid #fff; }

        input {
            background: #11111b; border: 1px solid #45475a; color: white;
            padding: 8px; border-radius: 4px; font-family: monospace; width: 100%; box-sizing: border-box; margin-top: 5px;
        }

        .status-box {
            background: #11111b; padding: 10px; border-radius: 6px; 
            margin-top: 10px; font-family: monospace; color: #a6e3a1; min-height: 40px;
            border: 1px solid #45475a; font-size: 0.9rem;
        }

        /* --- Tab 1: Obscurity --- */
        .black-box {
            background: #000; color: #333; padding: 20px; border: 2px solid #333;
            text-align: center; font-family: 'Courier New', monospace; margin-top: 10px;
        }
        .code-reveal {
            background: #1e1e2e; color: #f9e2af; padding: 10px;
            border: 1px dashed var(--obscure); font-family: monospace;
            white-space: pre-wrap; display: none; text-align: left; font-size: 0.85rem;
        }

        /* --- Tab 2: Kerckhoffs --- */
        .diagram-row { display: grid; grid-template-columns: 1fr 50px 1fr; gap: 10px; align-items: center; }
        .crypto-box { border: 1px solid #fff; padding: 10px; text-align: center; border-radius: 6px; }

        /* --- Tab 3: Peer Review --- */
        .code-editor {
            background: #1e1e2e; color: #cdd6f4; padding: 15px; border-radius: 6px;
            font-family: 'Consolas', monospace; border-left: 4px solid var(--review);
            position: relative;
        }
        .code-line { display: block; padding: 2px; cursor: pointer; }
        .code-line:hover { background: #313244; }
        .bug-found { background: rgba(243, 139, 168, 0.3) !important; border: 1px solid var(--obscure); }

    </style>
</head>
<body>

    <h1>CSSLP: Open Design & Kerckhoffs's Principle</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('obscurity')">1. Security by Obscurity</button>
        <button class="tab-btn" onclick="switchTab('open')">2. Kerckhoffs (Open Design)</button>
        <button class="tab-btn" onclick="switchTab('review')">3. Peer Review Challenge</button>
    </div>

    <!-- TAB 1: SECURITY BY OBSCURITY -->
    <div id="obscurity" class="tab-content active">
        <div class="card">
            <h3>Scenario: The "Secret" Algorithm</h3>
            <p><strong>The Fallacy:</strong> The developer hid the password logic inside a compiled function, believing no one can see it. They didn't use standard crypto.</p>
            
            <div class="black-box" id="blackBoxUI">
                [ PROPRIETARY SECURITY MODULE ]<br>
                [ ALGORITHM: UNKNOWN ]<br><br>
                ENTER ACCESS CODE:
                <input type="text" id="obsInput" placeholder="???">
                <button class="btn-obscure" onclick="checkObscure()">Validate</button>
            </div>
            
            <div class="status-box" id="obsResult">> Access Denied.</div>

            <div style="margin-top: 20px; border-top: 1px solid #444; padding-top: 10px;">
                <p><strong>Attacker Tools:</strong> Since the code is on the client (or the binary can be decompiled), the "Secret" is visible.</p>
                <button class="btn-tool" onclick="decompile()">üõ†Ô∏è Decompile / View Source</button>
                
                <div id="sourceCode" class="code-reveal">
// DECOMPILED SOURCE
function validate(input) {
  // The developer thought this was clever:
  var secret = "CSSLP" + new Date().getFullYear(); 
  // If year is 2025, pass is CSSLP2025
  return input === secret;
}
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 2: KERCKHOFFS PRINCIPLE -->
    <div id="open" class="tab-content">
        <div class="card">
            <h3>Scenario: Open Design (AES)</h3>
            <p><strong>The Principle:</strong> The algorithm (AES) is public. Everyone knows how it works. The security relies ENTIRELY on the Key.</p>

            <div class="diagram-row">
                <div class="crypto-box">
                    <strong>Plaintext</strong><br>
                    "Launch Missiles"
                </div>
                <div style="text-align:center">‚ûú</div>
                <div class="crypto-box" style="border-color:var(--open)">
                    <strong>Public Algo</strong><br>
                    AES-256
                </div>
            </div>

            <div style="margin-top:15px; background:#111; padding:10px; border-radius:6px;">
                <label>Key (The ONLY Secret):</label>
                <input type="text" id="aesKey" value="MySecretKey123" style="color:var(--open)">
                <button class="btn-open" onclick="runEncryption()">Encrypt</button>
            </div>

            <div class="status-box" id="aesOutput" style="color:#aaa; word-break:break-all;">
                > Ciphertext will appear here...
            </div>

            <p style="font-size:0.8rem; color:#aaa; margin-top:10px;">
                * Even though you know this is AES, and you can see the Javascript code executing it, you cannot reverse the Ciphertext above without the Key. <strong>This is Open Design.</strong>
            </p>
        </div>
    </div>

    <!-- TAB 3: PEER REVIEW -->
    <div id="review" class="tab-content">
        <div class="card">
            <h3>Scenario: Crowdsourcing / Peer Review</h3>
            <p><strong>Linus's Law:</strong> "Given enough eyeballs, all bugs are shallow."<br>
            Can you spot the security vulnerability in this Open Source snippet? Click the line of code that is dangerous.</p>

            <div class="code-editor">
                <span class="code-line" onclick="checkLine(1)">1  void processUser(char* input) {</span>
                <span class="code-line" onclick="checkLine(2)">2      char buffer[50];</span>
                <span class="code-line" onclick="checkLine(3)">3      int admin = 0;</span>
                <span class="code-line" onclick="checkLine(4)">4  </span>
                <span class="code-line" onclick="checkLine(5)">5      // Copy user input to buffer</span>
                <span class="code-line" onclick="checkLine(6)">6      strcpy(buffer, input);</span>
                <span class="code-line" onclick="checkLine(7)">7  </span>
                <span class="code-line" onclick="checkLine(8)">8      if (admin == 1) {</span>
                <span class="code-line" onclick="checkLine(9)">9          grantAccess();</span>
                <span class="code-line" onclick="checkLine(10)">10     }</span>
                <span class="code-line" onclick="checkLine(11)">11 }</span>
            </div>

            <div class="status-box" id="reviewResult">
                > Click the vulnerable line above...
            </div>
        </div>
    </div>

    <script>
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const map = {'obscurity':0, 'open':1, 'review':2};
            document.querySelectorAll('.tab-btn')[map[id]].classList.add('active');
        }

        /* --- OBSCURITY LOGIC --- */
        function checkObscure() {
            const input = document.getElementById('obsInput').value;
            const year = new Date().getFullYear();
            const secret = "CSSLP" + year;
            const res = document.getElementById('obsResult');

            if(input === secret) {
                res.innerHTML = "> ACCESS GRANTED. (You guessed the secret!)";
                res.style.color = "var(--open)";
            } else {
                res.innerHTML = "> ACCESS DENIED. The proprietary logic rejected you.";
                res.style.color = "var(--obscure)";
            }
        }

        function decompile() {
            const div = document.getElementById('sourceCode');
            div.style.display = 'block';
            div.innerHTML = `// DECOMPILED SOURCE
function validate(input) {
  // Hardcoded Logic Found!
  var secret = "CSSLP" + new Date().getFullYear(); 
  return input === secret;
}`;
        }

        /* --- OPEN DESIGN LOGIC --- */
        function runEncryption() {
            const key = document.getElementById('aesKey').value;
            if(!key) { alert("Enter a key"); return; }
            
            const plaintext = "Launch Missiles";
            const ciphertext = CryptoJS.AES.encrypt(plaintext, key).toString();
            
            document.getElementById('aesOutput').innerHTML = 
                `<strong>Ciphertext:</strong> ${ciphertext}<br><br>
                 <small>Algorithm: AES (Public)<br>Key: ${key} (Secret)</small>`;
        }

        /* --- PEER REVIEW LOGIC --- */
        function checkLine(num) {
            const res = document.getElementById('reviewResult');
            
            if (num === 6) {
                res.innerHTML = `‚úÖ <strong>CORRECT!</strong> 'strcpy' is vulnerable to Buffer Overflow. It doesn't check the length of 'input' vs 'buffer'. Use 'strncpy' instead.`;
                res.style.color = "var(--open)";
                event.target.classList.add('bug-found');
            } else {
                res.innerHTML = `‚ùå Line ${num} looks okay. Look for memory unsafe operations.`;
                res.style.color = "var(--obscure)";
            }
        }

    </script>
</body>
</html>