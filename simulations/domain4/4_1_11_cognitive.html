<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSLP Domain 4: Cognitive Computing Lab</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --panel-bg: #1e293b;
            --accent: #8b5cf6; /* Violet for Cognitive/AI */
            --danger: #ef4444;
            --success: #10b981;
            --text: #f1f5f9;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        header {
            background: #1e1b4b;
            width: 100%;
            padding: 20px 0;
            text-align: center;
            border-bottom: 3px solid var(--accent);
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        h1 { margin: 0; font-size: 1.8rem; color: #c4b5fd; }
        p.subtitle { color: #94a3b8; font-size: 0.9rem; margin-top: 5px; }

        .container {
            width: 95%;
            max-width: 1200px;
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            padding-bottom: 50px;
        }

        .card {
            background: var(--panel-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #334155;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
        }

        .card-header {
            border-bottom: 1px solid #334155;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        .card-title { font-size: 1.3rem; font-weight: 600; color: var(--accent); }
        .card-desc { font-size: 0.9rem; color: #94a3b8; margin-top: 5px; line-height: 1.5; }

        /* LAB 1: POISONING */
        #poison-canvas {
            background: #0f172a;
            border: 2px dashed #475569;
            border-radius: 8px;
            cursor: crosshair;
            margin-bottom: 15px;
        }
        .stat-box {
            background: #020617;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.9rem;
            color: #22d3ee;
            margin-bottom: 10px;
        }
        
        /* LAB 2: INVERSION */
        .api-box {
            background: #000;
            color: #10b981;
            font-family: 'Courier New', monospace;
            padding: 15px;
            border-radius: 6px;
            height: 150px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #334155;
        }
        .secret-grid {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin-bottom: 15px;
        }
        .secret-char {
            width: 30px; height: 40px;
            background: #334155;
            border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--text);
        }
        .secret-char.revealed { background: var(--accent); }

        /* LAB 3: AR */
        .ar-view {
            position: relative;
            height: 250px;
            background: url('https://images.unsplash.com/photo-1517694712202-14dd9538aa97?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60') center/cover;
            border-radius: 8px;
            overflow: hidden;
        }
        .ar-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid #fff;
            z-index: 10;
        }
        .malicious-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(239, 68, 68, 0.2); /* Red tint */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 2px 4px #000;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
            z-index: 20;
            border: 4px solid var(--danger);
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            margin-right: 8px;
        }
        button:hover { filter: brightness(1.2); }
        button.btn-reset { background: #475569; }
        button.btn-attack { background: var(--danger); }
        
        .tag { font-size: 0.75rem; padding: 2px 6px; border-radius: 4px; background: #334155; color: #94a3b8; }
        
    </style>
</head>
<body>

<header>
    <h1>Cognitive Computing Security Lab</h1>
    <p class="subtitle">CSSLP Domain 4: AI Poisoning, Model Inversion & AR Integrity</p>
</header>

<div class="container">

    <!-- LAB 1: DATA POISONING -->
    <div class="card">
        <div class="card-header">
            <span class="tag">AI INTEGRITY</span>
            <div class="card-title">Data Poisoning Simulator</div>
            <div class="card-desc">Attackers inject malicious training data to skew the model's decision boundary.</div>
        </div>
        
        <canvas id="poison-canvas" width="400" height="250"></canvas>
        <div class="stat-box" id="model-stats">Model Accuracy: 100% (Baseline)</div>
        
        <div style="margin-top: auto;">
            <p style="font-size:0.8rem; color:#94a3b8;">Click on the canvas to inject <span style="color:var(--danger)">Poison Data</span>.</p>
            <button class="btn-reset" onclick="resetPoisonLab()">Reset Data</button>
        </div>
    </div>

    <!-- LAB 2: MODEL INVERSION -->
    <div class="card">
        <div class="card-header">
            <span class="tag">AI CONFIDENTIALITY</span>
            <div class="card-title">Model Inversion Attack</div>
            <div class="card-desc">Querying a "Black Box" model to reconstruct hidden training data (PII).</div>
        </div>

        <div class="secret-grid" id="secret-display">
            <div class="secret-char">?</div>
            <div class="secret-char">?</div>
            <div class="secret-char">?</div>
            <div class="secret-char">?</div>
        </div>

        <div class="api-box" id="api-log">
            > Connection established to AI Inference API.<br>
            > Waiting for queries...
        </div>

        <div style="margin-top: auto;">
            <button class="btn-attack" onclick="runInversionAttack()">Run Inversion Attack</button>
        </div>
    </div>

    <!-- LAB 3: AR REALITY JACKING -->
    <div class="card">
        <div class="card-header">
            <span class="tag">AR INTEGRITY</span>
            <div class="card-title">AR Reality Jacking</div>
            <div class="card-desc">Malicious apps overlay fake information on top of critical real-world objects.</div>
        </div>

        <div class="ar-view">
            <div class="ar-overlay" id="legit-overlay">
                <h3>Secure Login</h3>
                <p>Enter PIN on Pad</p>
                <button style="background:#fff; color:#000; padding:5px 10px;">1 2 3</button>
            </div>
            <div class="malicious-overlay" id="mal-overlay">
                ⚠️ SYSTEM CRITICAL ERROR<br>Click Here to Fix
            </div>
        </div>

        <div style="margin-top: 20px;">
            <button class="btn-attack" onclick="toggleARAttack()">Toggle Overlay Attack</button>
            <p style="font-size:0.8rem; margin-top:10px; color:#94a3b8;">
                <strong>Architectural Mitigation:</strong> Trusted UI Layers (Z-Order Locking) prevent apps from drawing over system dialogs.
            </p>
        </div>
    </div>

</div>

<script>
    // --- LAB 1: POISONING LOGIC ---
    const canvas = document.getElementById('poison-canvas');
    const ctx = canvas.getContext('2d');
    const stats = document.getElementById('model-stats');
    
    // Initial "Good" Data
    let points = [
        {x: 50, y: 200, type: 'blue'}, {x: 80, y: 180, type: 'blue'}, {x: 30, y: 220, type: 'blue'}, // Bottom Left
        {x: 300, y: 50, type: 'green'}, {x: 350, y: 30, type: 'green'}, {x: 320, y: 80, type: 'green'} // Top Right
    ];

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw Points
        points.forEach(p => {
            ctx.fillStyle = p.type === 'blue' ? '#3b82f6' : (p.type === 'green' ? '#10b981' : '#ef4444');
            ctx.beginPath();
            ctx.arc(p.x, p.y, 5, 0, Math.PI * 2);
            ctx.fill();
        });

        // Calculate Average Centroids
        let blueC = getCentroid('blue');
        let greenC = getCentroid('green');
        let redC = getCentroid('red'); // Poison

        // Simple Decision Boundary (Perpendicular bisector between clusters)
        // If poison exists, it pulls the Green cluster centroid
        
        let effectiveGreenC = greenC;
        if (redC) {
            // Poison pulls the effective center of the 'Target' class
            effectiveGreenC = {
                x: (greenC.x + redC.x) / 2, 
                y: (greenC.y + redC.y) / 2
            };
        }

        // Draw Boundary Line
        ctx.strokeStyle = '#f1f5f9';
        ctx.lineWidth = 2;
        ctx.setLineDash([5, 5]);
        ctx.beginPath();
        // Visual approximation of decision boundary
        ctx.moveTo(0, canvas.height); 
        
        // Slope calculation simulation for visual
        let slope = (effectiveGreenC.y - blueC.y) / (effectiveGreenC.x - blueC.x);
        let midX = (effectiveGreenC.x + blueC.x) / 2;
        let midY = (effectiveGreenC.y + blueC.y) / 2;
        
        // Inverse slope for boundary
        ctx.moveTo(midX - 200, midY + (200/slope));
        ctx.lineTo(midX + 200, midY - (200/slope));
        ctx.stroke();

        // Stats Update
        if (points.some(p => p.type === 'red')) {
            stats.innerHTML = "<span style='color:#ef4444'>WARNING: Decision Boundary Shifted! Model Poisoned.</span>";
        } else {
            stats.innerHTML = "Model Accuracy: 100% (Stable Boundary)";
        }
    }

    function getCentroid(type) {
        let filt = points.filter(p => p.type === type);
        if (filt.length === 0) return null;
        let sumX = filt.reduce((a, b) => a + b.x, 0);
        let sumY = filt.reduce((a, b) => a + b.y, 0);
        return { x: sumX / filt.length, y: sumY / filt.length };
    }

    canvas.addEventListener('mousedown', (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        // Inject Poison (Red dots treated as Green by the attacker label)
        points.push({x: x, y: y, type: 'red'}); 
        draw();
    });

    function resetPoisonLab() {
        points = points.filter(p => p.type !== 'red');
        draw();
    }
    
    // Initial Draw
    draw();


    // --- LAB 2: INVERSION LOGIC ---
    const secret = "DATA";
    const apiLog = document.getElementById('api-log');
    const secretDisplay = document.getElementById('secret-display');
    
    async function runInversionAttack() {
        apiLog.innerHTML = "";
        const boxes = secretDisplay.children;
        
        // Reset display
        for(let b of boxes) { b.innerText = "?"; b.classList.remove('revealed'); }

        logApi("Initializing Gradient Descent Attack...");
        await wait(800);
        
        for (let i = 0; i < secret.length; i++) {
            logApi(`Probing Model for Feature [${i}]...`);
            await wait(400);
            
            // Simulation of confidence scores leaking data
            logApi(`> Confidence Score: 0.98 for char '${secret[i]}'`);
            
            boxes[i].innerText = secret[i];
            boxes[i].classList.add('revealed');
            await wait(400);
        }
        
        logApi("<span style='color:#ef4444'>SUCCESS: Training data reconstructed from model outputs.</span>");
    }

    function logApi(msg) {
        apiLog.innerHTML += `> ${msg}<br>`;
        apiLog.scrollTop = apiLog.scrollHeight;
    }

    function wait(ms) { return new Promise(r => setTimeout(r, ms)); }


    // --- LAB 3: AR ATTACK LOGIC ---
    let arAttackActive = false;
    const malOverlay = document.getElementById('mal-overlay');
    
    function toggleARAttack() {
        arAttackActive = !arAttackActive;
        if (arAttackActive) {
            malOverlay.style.opacity = 1;
            malOverlay.style.pointerEvents = 'auto';
        } else {
            malOverlay.style.opacity = 0;
            malOverlay.style.pointerEvents = 'none';
        }
    }

</script>

</body>
</html>